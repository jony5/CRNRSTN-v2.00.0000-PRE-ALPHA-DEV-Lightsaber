<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd"><html><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"><title>CRNRSTN :: Code Example</title></head><body><p>Please note that if cookie encryption is initialized with $cipherStrength instead of $cipherName, the C<span class="the_R">R</span>NRSTN Suite :: will use mcrypt_list_algorithms() to internally/real-time auto-detect the list of available mcrypt ciphers in the running environment, and it will choose a cipher which most closely matches the results of our analysis of the cipher performance observations collected while conducting mcrypt library cipher testing during the development of this class library.<br />
<br />
The hosting environments added to the C<span class="the_R">R</span>NRSTN Suite in lines 32-36 of the example below are each uniquely configured for cookie encryption in lines 67-79.<br />
<br />
As with auto-detect of the environment for certain invocations of <a href="../../../classes/crnrstn/requireddetectionmatches/" target="_self">requiredDetectionMatches()</a>, there is a slight performance degradation associated with cipher auto-detection (i.e. method invocation via integer rather than via cipher name), but this performance hit is negated in subsequent requests after the session has been initialized due to smart caching within the C<span class="the_R">R</span>NRSTN Suite ::.</p><div id="example_scrollto_0" class="example_scrollto" onClick="initScrollTo_lnk(this,'http://192.168.172.135/crnrstn/crnrstn/documentation/classes/crnrstn/initcookieencryption/?ns=crnrstn');"><a href="#" target="_self">Link</a>.</div><div id="crnrstn_bffb1cbed6ed79589cf4_0" class="code_wrapper"><div id="lineNum_1850352597" class="l_num">1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>50<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>58<br>59<br>60<br>61<br>62<br>63<br><br><br><br><br></div><div class="code_shell"><code>
<span class="code_str_qtd">&lt;?php</span><br><span CLASS="code_comment">
/*</span><br><span CLASS="code_comment">
// J5</span><br>
<span CLASS="code_comment">// Code is Poetry */</span><br>
<span id="6c399a691382212fff05_1010558996j00000101" class="code_sysfunc_call" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">session_start</span>();<br>
<br>
<span CLASS="code_comment"># THE CRNRSTN SUITE :: STACK OF CLASS DEFINITIONS [OPT = optional]</span><br>
<span id="b7a73b3bf3e58d97abca_1307274037j00000101" class="code_log_exp" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">require</span>(<span class="code_str_qtd">'./_crnrstn.root.inc.php'</span>);<br>
<span id="b7a73b3bf3e58d97abca_421434083j00000101" class="code_log_exp" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">require</span>($ROOT.<span class="code_str_qtd">'/_crnrstn/classes/crnrstn/crnrstn.inc.php'</span>);<span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="code_comment">// CRNRSTN</span><br>
<span id="b7a73b3bf3e58d97abca_1255250913j00000101" class="code_log_exp" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">require</span>($ROOT.<span class="code_str_qtd">'/_crnrstn/classes/logging/crnrstn.log.inc.php'</span>);<span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="code_comment">// LOGGING</span><br>
<span id="b7a73b3bf3e58d97abca_1028733132j00000101" class="code_log_exp" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">require</span>($ROOT.<span class="code_str_qtd">'/_crnrstn/classes/environmentals/crnrstn.env.inc.php'</span>);<span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="code_comment">// ENVIRONMENTALS</span><br>
<span id="b7a73b3bf3e58d97abca_1599217577j00000101" class="code_log_exp" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">require</span>($ROOT.<span class="code_str_qtd">'/_crnrstn/classes/security/crnrstn.ipauthmgr.inc.php'</span>);<span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="code_comment">// SECURITY</span><br>
<span id="b7a73b3bf3e58d97abca_2747543j00000101" class="code_log_exp" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">require</span>($ROOT.<span class="code_str_qtd">'/_crnrstn/classes/security/crnrstn.ciphermgr.inc.php'</span>);<span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="code_comment">// ENCRYPTION</span><br>
<span id="b7a73b3bf3e58d97abca_985012363j00000101" class="code_log_exp" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">require</span>($ROOT.<span class="code_str_qtd">'/_crnrstn/classes/database/mysqli/crnrstn.mysqli.inc.php'</span>);<span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="code_comment">// DATABASE</span><br>
<span id="b7a73b3bf3e58d97abca_743507087j00000101" class="code_log_exp" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">require</span>($ROOT.<span class="code_str_qtd">'/_crnrstn/classes/soa/nusoap/nusoap.php'</span>);<span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="code_comment">// NUSOAP (3RD PARTY CLIENT/SERVER SOAP)</span><br>
<span id="b7a73b3bf3e58d97abca_1001816194j00000101" class="code_log_exp" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">require</span>($ROOT.<span class="code_str_qtd">'/_crnrstn/classes/soa/nusoap/class.wsdlcache.php'</span>);<span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="code_comment">// NUSOAP (3RD PARTY CLIENT/SERVER SOAP)</span><br>
<span id="b7a73b3bf3e58d97abca_242947200j00000101" class="code_log_exp" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">require</span>($ROOT.<span class="code_str_qtd">'/_crnrstn/classes/soa/crnrstn.soap.inc.php'</span>);<span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="code_comment">// SOAP MANAGEMENT</span><br>
<span id="b7a73b3bf3e58d97abca_920788277j00000101" class="code_log_exp" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">require</span>($ROOT.<span class="code_str_qtd">'/_crnrstn/classes/session/crnrstn.session.inc.php'</span>);<span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="code_comment">// SESSION MANAGEMENT</span><br>
<span id="b7a73b3bf3e58d97abca_1496001815j00000101" class="code_log_exp" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">require</span>($ROOT.<span class="code_str_qtd">'/_crnrstn/classes/session/crnrstn.cookie.inc.php'</span>);<span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="code_comment">// COOKIE MANAGEMENT</span><br>
<span id="b7a73b3bf3e58d97abca_1019093460j00000101" class="code_log_exp" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">require</span>($ROOT.<span class="code_str_qtd">'/_crnrstn/classes/session/crnrstn.http.inc.php'</span>);<span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="code_comment">// HTTP MANAGEMENT</span><br>
<br>
<span CLASS="code_comment">//</span><br>
<span CLASS="code_comment">// INSTANTIATE AN INSTANCE OF CRNRSTN BY PASSING SERVER SUPER GLOBAL AND UNIQUE CONFIG SERIAL</span><br>
$oCRNRSTN = <span id="f109c58b6897e5839fe2_998120370j000001011" class="code_log_exp" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">new</span> crnrstn(<span id="3b2edfd71817df77a304_j000001011382427650" class="code_html_doc_type_tag" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">$_SERVER</span>,<span class="code_str_qtd">'RrI5nh3'</span>);<br>
<br>
<span CLASS="code_comment">//</span><br>
<span CLASS="code_comment">// REQUIRED $_SERVER ENVIRONMENT DETECTION MATCHES</span><br>
$oCRNRSTN-&gt;requiredDetectionMatches(3);<span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><br>
<br>
<span CLASS="code_comment">//</span><br>
<span CLASS="code_comment">// CONFIGURE CRNRSTN FOR THE FOLLOWING HOSTING ENVIRONMENTS</span><br>
$oCRNRSTN-&gt;addEnvironment(<span class="code_str_qtd">'LOCALHOST_MY_OLD_MAC_TOWER'</span>, <span id="b340155e95c6efe29beb_1223670074j00000101" class="code_system_constants" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">E_ALL</span> &amp; ~<span id="5340722603173e83b56b_j00000101775414533" class="code_system_constants" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">E_NOTICE</span>);<br>
$oCRNRSTN-&gt;addEnvironment(<span class="code_str_qtd">'PREPROD'</span>, <span id="b340155e95c6efe29beb_825773817j00000101" class="code_system_constants" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">E_ALL</span> &amp; ~<span id="5340722603173e83b56b_j00000101135556665" class="code_system_constants" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">E_NOTICE</span>);<br>
$oCRNRSTN-&gt;addEnvironment(<span class="code_str_qtd">'000WEBHOSTJONY5'</span>, <span id="b340155e95c6efe29beb_532841463j00000101" class="code_system_constants" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">E_ALL</span> &amp; ~<span id="5340722603173e83b56b_j000001012024350600" class="code_system_constants" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">E_NOTICE</span> &amp; ~<span id="677c6f7f346ee775bcd5_j00000101633069143" class="code_system_constants" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">E_STRICT</span>);<br>
$oCRNRSTN-&gt;addEnvironment(<span class="code_str_qtd">'PROD_01'</span>, <span id="b340155e95c6efe29beb_1879219563j00000101" class="code_system_constants" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">E_ALL</span> &amp; ~<span id="be48e4758132952ab363_j000001011590727024" class="code_system_constants" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">E_DEPRECATED</span> &amp; ~<span id="677c6f7f346ee775bcd5_j000001011569210824" class="code_system_constants" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">E_STRICT</span>);<br>
$oCRNRSTN-&gt;addEnvironment(<span class="code_str_qtd">'LOCALHOST_PC'</span>, <span id="b340155e95c6efe29beb_1475127963j00000101" class="code_system_constants" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">E_ALL</span> &amp; ~<span id="5340722603173e83b56b_j00000101135308360" class="code_system_constants" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">E_NOTICE</span> &amp; ~<span id="677c6f7f346ee775bcd5_j00000101181815934" class="code_system_constants" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">E_STRICT</span>);<br>
<br>
<span CLASS="code_comment">//</span><br>
<span CLASS="code_comment">// CONFIGURE LOGGING PROFILES FOR THE FOLLOWING HOSTING ENVIRONMENTS</span><br>
$oCRNRSTN-&gt;initLogging(<span class="code_str_qtd">'PREPROD'</span>);<span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="code_comment">// SYSTEM DEFAULT ERROR LOGGING</span><br>
$oCRNRSTN-&gt;initLogging(<span class="code_str_qtd">'LOCALHOST_MY_OLD_MAC_TOWER'</span>, <span class="code_str_qtd">'SCREEN'</span>);<span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="code_comment">// SEND OUTPUT TO SCREEN</span><br>
$oCRNRSTN-&gt;initLogging(<span class="code_str_qtd">'000WEBHOSTJONY5'</span>, <span class="code_str_qtd">'EMAIL'</span>,<span class="code_str_qtd">'email1@domain.com,email2@domain.com'</span>);<span CLASS="tab">&nbsp;</span><span CLASS="code_comment">// EMAIL LOG TRANSACTION TO LIST OF COMMA DELIMITED EMAIL ACCOUNTS</span><br>
$oCRNRSTN-&gt;initLogging(<span class="code_str_qtd">'PROD_01'</span>, <span class="code_str_qtd">'FILE'</span>,<span class="code_str_qtd">'/var/log/customlogs/crnrstnlogs.txt'</span>);<span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="code_comment">// PATH TO FOLDER &amp; FILE WHERE LOG DATA WILL BE APPENDEED</span><br>
$oCRNRSTN-&gt;initLogging(<span class="code_str_qtd">'LOCALHOST_PC'</span>, <span class="code_str_qtd">'DEFAULT'</span>);<span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="tab">&nbsp;</span><span CLASS="code_comment">// SYSTEM DEFAULT ERROR LOGGING</span><br>
<br>
<span CLASS="code_comment">//</span><br>
<span CLASS="code_comment">// INITIALIZE SESSION ENCRYPTION PROFILES [PREPROD &amp; LOCALHOST_PC ARE THE SAME]</span><br>
<span CLASS="code_comment"># CIPHER AUTO-DETECT. USE STRENGTH OF 5.</span><br>
$oCRNRSTN-&gt;initSessionEncryption(<span class="code_str_qtd">'LOCALHOST_MY_OLD_MAC_TOWER'</span>, <span class="code_str_qtd">'5'</span>);<br>
<br>
<span CLASS="code_comment"># SAME AS initSessionEncryption(LOCALHOST_PC, 1);</span><br>
$oCRNRSTN-&gt;initSessionEncryption(<span class="code_str_qtd">'PREPROD'</span>);<br>
<br>
<span CLASS="code_comment"># USE cast-128. WILL IGNORE SPECIFIED MAX STRENGTH OF 8.</span><br>
$oCRNRSTN-&gt;initSessionEncryption(<span class="code_str_qtd">'000WEBHOSTJONY5'</span>, <span class="code_str_qtd">'8'</span>, <span class="code_str_qtd">'cast-128'</span>);<br>
<br>
<span CLASS="code_comment"># NO SESSION ENCRYPTION</span><br>
$oCRNRSTN-&gt;initSessionEncryption(<span class="code_str_qtd">'PROD_01'</span>, <span class="code_str_qtd">'0'</span>);<br>
<br>
<span CLASS="code_comment"># WILL USE cast-128 (OR NEXT CLOSEST CIPHER) WITH MINIMUM STRENGTH OF 1.</span><br>
$oCRNRSTN-&gt;initSessionEncryption(<span class="code_str_qtd">'LOCALHOST_PC'</span>, 1);<br>
</code></div></div><blockquote>Configuration of the cookie encryption settings for each of the environments added to the C<span class="the_R">R</span>NRSTN Suite :: in lines 32-36 (above) is performed below. <br />
<br />
To see a complete example of the C<span class="the_R">R</span>NRSTN Suite :: configuration file, click <a href="../../../classes/environmentals/" target="_self">here</a>. For a more tutorial-ish presentation of the progression through the same, click <a href="../../../classes/crnrstn/grantexclusiveaccess/" target="_self">here</a> for documentation and examples covering the next few lines.</blockquote><div id="example_scrollto_1" class="example_scrollto" onClick="initScrollTo_lnk(this,'http://192.168.172.135/crnrstn/crnrstn/documentation/classes/crnrstn/initcookieencryption/?ns=crnrstn');"><a href="#" target="_self">Link</a>.</div><div id="crnrstn_bffb1cbed6ed79589cf4_1" class="code_wrapper"><div id="lineNum_698114050" class="l_num">64<br>65<br>66<br>67<br>68<br>69<br>70<br>71<br>72<br>73<br>74<br>75<br>76<br>77<br>78<br>79<br>80<br>81<br>82<br>83<br><br><br><br><br></div><div class="code_shell"><code>
<span CLASS="code_comment">//</span><br>
<span CLASS="code_comment">// INITIALIZE COOKIE ENCRYPTION PROFILES [PREPROD &amp; LOCALHOST_PC ARE THE SAME]</span><br>
<span CLASS="code_comment"># CIPHER AUTO-DETECT. USE STRENGTH OF 5.</span><br>
$oCRNRSTN-&gt;initCookieEncryption(<span class="code_str_qtd">'LOCALHOST_MY_OLD_MAC_TOWER'</span>, <span class="code_str_qtd">'5'</span>);<br>
<br>
<span CLASS="code_comment"># SAME AS initSessionEncryption(LOCALHOST_PC, 1);</span><br>
$oCRNRSTN-&gt;initCookieEncryption(<span class="code_str_qtd">'PREPROD'</span>);<br>
<br>
<span CLASS="code_comment"># USE cast-128. WILL IGNORE SPECIFIED MAX STRENGTH OF 8.</span><br>
$oCRNRSTN-&gt;initCookieEncryption(<span class="code_str_qtd">'000WEBHOSTJONY5'</span>, <span class="code_str_qtd">'8'</span>, <span class="code_str_qtd">'cast-128'</span>);<br>
<br>
<span CLASS="code_comment"># NO SESSION ENCRYPTION</span><br>
$oCRNRSTN-&gt;initCookieEncryption(<span class="code_str_qtd">'PROD_01'</span>, <span class="code_str_qtd">'0'</span>);<br>
<br>
<span CLASS="code_comment"># WILL USE cast-128 (OR NEXT CLOSEST CIPHER) WITH MINIMUM STRENGTH OF 1.</span><br>
$oCRNRSTN-&gt;initCookieEncryption(<span class="code_str_qtd">'LOCALHOST_PC'</span>, 1);<br>
<br>
<span class="code_str_qtd">?&gt;</span><br>
</code></div></div><div class="example_title_wrapper"><code style="color:#FF0000;">Figure 5.</code></div><div class="cb_15"></div><div class="comment_tt_wrapper"><span id="6c399a691382212fff05_0614246001462250543j00000101" class="tt_agg_extract" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">session_start</span> <span class="code_tt_space">&nbsp;</span><span id="b7a73b3bf3e58d97abca_0642131001462250543j00000101" class="tt_agg_extract" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">require</span> <span class="code_tt_space">&nbsp;</span><span id="f109c58b6897e5839fe2_0263572001462250544j000001011" class="tt_agg_extract" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">new</span> <span class="code_tt_space">&nbsp;</span><span id="3b2edfd71817df77a304_j000001010267574001462250544" class="tt_agg_extract" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">$_SERVER</span> <span class="code_tt_space">&nbsp;</span><span id="b340155e95c6efe29beb_0378421001462250544j00000101" class="tt_agg_extract" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">E_ALL</span> <span class="code_tt_space">&nbsp;</span><span id="5340722603173e83b56b_j000001010382901001462250544" class="tt_agg_extract" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">E_NOTICE</span> <span class="code_tt_space">&nbsp;</span><span id="677c6f7f346ee775bcd5_j000001010406120001462250544" class="tt_agg_extract" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">E_STRICT</span> <span class="code_tt_space">&nbsp;</span><span id="be48e4758132952ab363_j000001010416323001462250544" class="tt_agg_extract" onMouseOver="ttMsOvr(this);" onMouseOut="ttMsOut(this);">E_DEPRECATED</span> <span class="code_tt_space">&nbsp;</span></div><div class="cb_15"></div></body></html>